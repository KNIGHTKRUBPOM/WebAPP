<!DOCTYPE html>
<html>
    <head></head>
    <body>
        <div id="maincontainer"></div>
        <script>
            const container = document.getElementById('maincontainer');
            // Title
            const title = document.createElement('h1');
            title.textContent = "Exercise 14: JavaScript&DOM";
            container.appendChild(title);

            // ปุ่มเริ่มต้น
            let startButton = document.createElement('button');
            startButton.textContent = "Click me to display Date and Time";
            container.appendChild(startButton);

            // ปุ่มแสดงเวลา
            let timeButton = document.createElement('button');
            timeButton.style.display = "none";
            container.appendChild(timeButton);

            // ตัวเก็บสีล่าสุด
            let lastBgColor = "#000000";
            let lastTextColor = "#FFFFFF";

            // Web Worker
            const worker = new Worker('web_worker.js');
            let running = false;

            worker.onmessage = (e) => {
                if (e.data.reset) {
                    // สร้างปุ่มใหม่ใต้ h1 แสดงวัน/เวลา
                    timeButton.style.display = "inline";
                    timeButton.style.position = "static";
                    timeButton.style.margin = "5px 0";
                    timeButton.textContent = new Date().toString();
                    timeButton.style.backgroundColor = lastBgColor;
                    timeButton.style.color = lastTextColor;

                    // เพิ่ม event ให้กดแล้วเด้งไปมุมขวาบนได้
                    timeButton.onclick = togglePosition;
                } else {
                    timeButton.textContent = e.data.timeString;
                    timeButton.style.backgroundColor = e.data.bgColor;
                    timeButton.style.color = e.data.textColor;

                    lastBgColor = e.data.bgColor;
                    lastTextColor = e.data.textColor;
                }
            };

            function toggleTime() {
                if (!running) {
                    startButton.style.display = "none";
                    timeButton.style.display = "inline";

                    // ย้ายปุ่มไปมุมขวาบน
                    timeButton.style.position = "fixed";
                    timeButton.style.top = "0px";
                    timeButton.style.right = "0px";
                    timeButton.style.margin = "0";
                    timeButton.style.borderRadius = "0";
                    timeButton.style.padding = "5px 10px";

                    worker.postMessage({ command: 'start' });

                    // --- อัปเดตครั้งแรก (แก้ตรงนี้ให้ขึ้นทันที + สีแดง) ---
                    // --- อัปเดตครั้งแรก (แก้ตรงนี้ให้ขึ้นทันที + สีแดง) ---
                    const now = new Date();
                    timeButton.textContent = now.toString();
                    
                } else {
                    worker.postMessage({ command: 'stop' });
                }
                running = !running;
            }

            startButton.addEventListener('click', toggleTime);
            timeButton.addEventListener('click', toggleTime);

            // --- ฟังก์ชันสลับตำแหน่งปุ่มหลัง stop ---
            let atTopRight = false;

            function togglePosition() {
                if (!atTopRight) {
                    // เด้งไปมุมขวาบน
                    timeButton.style.position = "fixed";
                    timeButton.style.top = "0px";
                    timeButton.style.right = "0px";
                    timeButton.style.margin = "0";
                    timeButton.style.borderRadius = "0";
                    timeButton.style.padding = "5px 10px";
                    atTopRight = true;
                } else {
                    // กลับใต้ h1
                    timeButton.style.position = "static";
                    timeButton.style.margin = "5px 0";
                    timeButton.style.borderRadius = "";
                    timeButton.style.padding = "";
                    atTopRight = false;
                }
            }

            // สร้างปุ่ม
            // สร้างปุ่ม
            const personalBtn = document.createElement("button");
            personalBtn.textContent = "Personal Info";

            // ทำให้มีเส้นใต้ (textDecoration)
            personalBtn.style.textDecoration = "underline";
            personalBtn.style.border = "none";
            personalBtn.style.background = "transparent";
            personalBtn.style.cursor = "pointer";
            personalBtn.style.fontSize = "16px";
            personalBtn.style.color = "pink";
            // ✅ Fix ตำแหน่งปุ่มให้อยู่กับที่
            personalBtn.style.position = "fixed";
            personalBtn.style.top = "130px";   // เดิม 60px → เลื่อนลงมา 20px
            personalBtn.style.left = "20px";
            personalBtn.style.display = "block";

            // hover effect โดยใช้ JS ไม่ใช้ CSS
            personalBtn.addEventListener("mouseenter", () => {
                personalBtn.style.backgroundColor = "yellow";
                personalBtn.style.color = "blue"; // เปลี่ยนฟอนต์เป็นสีน้ำเงิน
            });
            personalBtn.addEventListener("mouseleave", () => {
                personalBtn.style.backgroundColor = "transparent";
                personalBtn.style.color = "pink"; // กลับเป็นสีชมพูเดิม
            });

            // element สำหรับเก็บข้อมูล (สร้าง ul)
            const infoList = document.createElement("ul");
            infoList.style.marginLeft = "20px";  
            infoList.style.position = "fixed";    // ✅ Fix ตำแหน่งเช่นกัน
            infoList.style.top = "150px";         // ให้อยู่ใต้ปุ่ม Personal Info (80px + 30px ประมาณ)
            infoList.style.left = "40px";
            infoList.style.display = "none";      // เริ่มต้นซ่อน

            // เพิ่มข้อมูล
            const infoItems = [
                "Athichanan Chanthamit ID : 67015155",
                "Subject : Web App",
                "Semester : 2"
            ];
            infoItems.forEach(text => {
                const li = document.createElement("li");
                li.textContent = text;
                infoList.appendChild(li);
            });

            // toggle แสดง/ซ่อน เมื่อกดปุ่ม
            let infoVisible = false;
            personalBtn.addEventListener("click", () => {
                infoVisible = !infoVisible;
                infoList.style.display = infoVisible ? "block" : "none";
            });

            // เพิ่มปุ่มและข้อมูลลง container
            container.appendChild(personalBtn);
            container.appendChild(infoList);



        </script>
    </body>
</html>
